{% extends 'bka/dg/main_dg.html' %}

{% load crispy_forms_tags %}
{% block content %}

<br>

<div class="row">
    <div class="container col-md-6">
        <div class="card text-white bg-secondary mb-3">
            <div class="card-header">Formulaire de validation</div>
            <div class="card-body">

                <form action="" id="validation_installation_informationForm" method="POST" data-services-url="{% url 'ajax_load_services' %}">
            
                {% csrf_token %}
                
                {{ form.instance.customer }} <hr>
                {{ form.instance.lat}} <hr>
                {{ form.instance.lon }} <hr>
                {{ form.forfait | as_crispy_field }}
                {{ form.service | as_crispy_field }}

                <button class="btn btn-light" type="submit" name="submit">
                    valider formulaire
                </button>

                </form>

            </div>
        </div>
    </div>
</div>

{% endblock %}

<script>
    $("#id_forfait").change(function (){
        const url = $("#validation_installation_informationForm").attr("data-services-url");
        const idForfait = $(this).val(); 

        $.ajax({
            url: url,
            data: {
                'forfait_id': idForfait
            },
            success: function(data){
                $("#id_service").html(data);
            }
        });
    });
</script>
