{% extends 'bka/dg/main_dg.html' %}

{% load crispy_forms_tags %}
{% block content %}

<br>

<div class="row">
    <div class="container col-md-6">
        <div class="card text-white bg-secondary mb-3">
            <div class="card-header">Formulaire de validation</div>
            <div class="card-body">

                <form action="" id="validation_installation_informationForm" method="POST">
            
                {% csrf_token %}
                
                {{ form.instance.customer }} <hr>
                {{ form.instance.lat}} <hr>
                {{ form.instance.lon }} <hr>
                {{ form.forfait | as_crispy_field }}
                {{ form.service | as_crispy_field }}

                <select>
                    <option selected disabled="true">--- Choisir Forfait ---</option>
                    {% for forfait in forfaits %}
                        <option value="{{forfait.forfait_id}}">{{forfait.nom}}</option>
                    {% endfor %}
                </select>

                <select>
                    <option selected disabled="true">--- Choisir Service ---</option>
                    {% for service in services %}
                        <option value="{{service.service_id}}">{{service.nom_service}}</option>
                    {% endfor %}
                </select>

                <button class="btn btn-light" type="submit" name="submit">
                    valider formulaire
                </button>

                </form>

            </div>
        </div>
    </div>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
            
<script>
    $("#id_forfait").change(function (){
        const url = $("#validation_installation_informationForm").attr("data-services-url");
        const ForfaitId = $(this).val(); 

        $.ajax({
            url: url,
            data: {
                'forfait_id': ForfaitId
            },
            success: function(data){
                $("#id_service").html(data);
            }
        });
    });
</script>


{% endblock %}
