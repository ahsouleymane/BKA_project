{% extends 'bka/tech/main_tech.html' %}

{% load crispy_forms_tags %}
{% block content %}

<br>

<div class="row">
    <div class="container col-md-6">
        <div class="card text-white bg-secondary mb-3">
            <div class="card-header">Editer des coordonn√©es</div>
            <div class="card-body">

                <form method="POST" id="validation_installation_informationForm" data-services-url="{% url 'ajax_load_services' %}">
            
                {% csrf_token %}

                {% for message in messages %}
                    <p style="color: yellowgreen; text-align: center;" id="messages">{{ message }}</p>
                {% endfor %}
                
                {{ form.customer | as_crispy_field }}
                {{ form.lat | as_crispy_field }}
                {{ form.lon | as_crispy_field }}
                {{ form.forfait | as_crispy_field }}
                {{ form.service | as_crispy_field }}


                <button class="btn btn-sm btn-light" type="submit" name="submit">
                    valider formulaire
                </button>
                <a class="btn btn-danger btn-sm" type="button" href="{% url 'list_coordinates' %}">Annuler</a>

                </form>

                <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
                <script>
                    $("#id_forfait").change(function (){
                        const url = $("#validation_installation_informationForm").attr("data-services-url");
                        const idForfait = $(this).val(); 
                
                        $.ajax({
                            url: url,
                            data: {
                                'forfait_id': idForfait
                            },
                            success: function(data){
                                $("#id_service").html(data);
                            }
                        });
                    });
                </script>

            </div>
        </div>
    </div>
</div>

{% endblock %}